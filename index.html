<!DOCTYPE html>
<html>
<head>
	<title>Giphy API</title>

	<!-- Reset CSS -->
	<link rel="stylesheet" type="text/css" href="assets/css/reset.css">

	<!-- My Style CSS -->
	<link rel="stylesheet" type="text/css" href="assets/css/style.css">

	<!-- Bootstrap CDN -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

	<!-- Jquery CDN -->
	<script
	  src="https://code.jquery.com/jquery-3.2.1.min.js"
	  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
	  crossorigin="anonymous">
 	</script>

</head>
<body>

<div class = "container-fluid">
	<div class = "well">
	<h1>GIF BUTTONS</h1>
	<div id="gif-buttons">
	</div>
	</div>
</div>

<div class = "container-fluid">
	<div class = "row">
	
		<div class = "col-md-8">
			<div class = "panel panel-default">
				<div class = "panel-heading">
					<h1>GIF IMAGES</h1>
				</div>
				<div class = "panel-body">
					<div id="gif-images"></div>
				</div>
			</div>
		</div>

		<div class = "col-md-4">
			<div class = "well" id="submit-form">
				<h1>SUBMISSION FORM</h1>
				<div class="form-group">
	                <label>Gif Search Term:</label>
	                <input type="text" class="form-control" id="search">
	            </div>
	            <button type="submit" class="btn btn-primary" id="submitGIF">Make a Giphhy button!</button>
			</div>
		</div>


	</div>
</div>





<script type="text/javascript">

var topics = ["pug", "dalmatian", "retriever", "bulldog", "chihuahua"];

function clearButtons(){
	$("#gif-buttons").empty();
}


function makeButtons(){
	for(var i = 0; i <  topics.length; i++){
		var btnMaker = $("<button>");
		btnMaker.attr("data-name", topics[i]);
		btnMaker.text(topics[i]);
		btnMaker.attr("type", "button");
		btnMaker.addClass("btn btn-info");
		$("#gif-buttons").append(btnMaker);
	}
}
	
$("#submitGIF").on("click", function(){
	event.preventDefault();
	var userEntry = $("#search").val().trim();
	topics.push(userEntry);
	clearButtons();
	makeButtons();

});



$(document).on("click", ".btn-info", function(){ 
	var gifSelect = $(this).text();

	// Log the text of the button user selected
	// console.log(gifSelect);
	//Push that value to the api link
	var queryURL = "https://api.giphy.com/v1/gifs/search?api_key=dc6zaTOxFJmzC&limit=10&q=" + gifSelect;

	$.ajax({
		url: queryURL,
		method: "GET"
	})
	.done(function(response){
		for(var j = 0; j < response.data.length; j++){
			//create divs to hold both rating and images
			//create the div 
			var imgDiv = $("<div>");
			//add class for CSS formatting
			imgDiv.addClass("images-divs");
			//publish the rating of the gif in the div
			imgDiv.append("<h2> Rating: " + response.data[j].rating + "</h2>");
			
			//create img tags to hold the gif images
			var gifImg = $("<img>");

			//set src and attributes of gif images
			//original source is the still of the gif
			gifImg.attr("src", response.data[j].images.fixed_height_still.url);
			//creating a data type to hold the still image and applying the attribute
			var stopURL = response.data[j].images.fixed_height_still.url;
			gifImg.attr("data-stillURL", stopURL);
			gifImg.attr("data-status", "still");
			//creating a data type to hold the moving gif and applying the attribute
			var playURL = response.data[j].images.fixed_height.url
			gifImg.attr("data-playURL", playURL);

			//append the img to the div created earlier
			imgDiv.append(gifImg);

			//prepend all the images to the gif images panel
			$("#gif-images").prepend(imgDiv);
		}

		$("img").on("click", function(){
			var gifStatus = $(this).attr("data-status");
			if(gifStatus === "still"){
				var playAGif = $(this).attr("data-playURL");
				$(this).attr("data-status", "play");
				$(this).attr("src", playAGif);
			} 
			if (gifStatus === "play"){
				var stopAGif = $(this).attr("data-stillURL");
				$(this).attr("data-status", "still");
				$(this).attr("src", stopAGif);
			}

		})

	});


});

makeButtons();


</script>
</body>
</html>